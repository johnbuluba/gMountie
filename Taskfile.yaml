version: '3'

tasks:
  gen:grpc:
    cmds:
      - |
        protoc --go_out=. --go-grpc_out=. api/proto/*.proto

  gen:mocks:
    cmds:
      - rm -rf mocks
      - go run github.com/vektra/mockery/v2@v2.46.3

  test:
    cmds:
      - go test -p=1 ./... $TEST_EXTRA_ARGS

  build:server:
    cmds:
      - go build -o out/server cmd/server/main.go

